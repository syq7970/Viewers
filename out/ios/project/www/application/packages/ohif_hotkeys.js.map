)]}'
{"version":3,"sources":["meteor://ðŸ’»app/packages/ohif:hotkeys/main.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/index.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/classes/HotkeysContext.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/classes/HotkeysManager.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/components/form.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/components/formTable.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/components/index.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/lib/index.js","meteor://ðŸ’»app/packages/ohif:hotkeys/client/lib/routes.js"],"names":["module","export","hotkeys","OHIF","watch","require","v","HotkeysManager","HotkeysContext","name","definitions","enabled","Object","assign","extend","keys","forEach","hotkey","command","unregister","register","log","warn","bindingKey","bind","$","document","get","commands","run","event","preventDefault","Array","unbind","initialize","destroy","Meteor","ReactiveVar","Tracker","Session","contexts","defaults","currentContextName","retrieveFunction","storeFunction","changeObserver","Dependency","autorun","contextName","context","nonreactive","switchToContext","setRetrieveFunction","setStoreFunction","store","storageKey","Promise","resolve","reject","call","then","catch","userId","user","setData","setPersistent","retrieve","getData","error","disable","set","enable","getContext","getCurrentContext","load","defs","changed","contextDefinitions","isDefaultDefinitions","currentContext","unsetContext","resetDefauls","newContext","Template","_","hotkeysForm","onCreated","instance","data","api","save","form","first","value","promise","successMessage","ui","notifications","success","text","hotkeysDefinitions","resetDefaults","dialogOptions","title","message","showDialog","rg","start","end","range","allowedKeys","union","updateInputText","displayPressedKey","$target","currentTarget","keysPressedArray","getKeysPressedArray","specialKeyName","jQuery","specialKeys","which","keyName","String","fromCharCode","keyCode","key","push","toUpperCase","val","join","ctrlKey","altKey","shiftKey","getConflictingCommand","currentCommand","currentCombination","conflict","each","combination","disallowedCombinations","ALT","SHIFT","CTRL","hotkeysContext","events","stopPropagation","indexOf","trigger","split","lastKey","pop","modifierCombination","isModifier","formItem","conflictedCommand","focus","blurTrigger","toggleTooltip","placement","closest","length","commandsContext","popoverData","conflictedFunctionName","newFunctionName","hotkeyCombination","popoverOptions","conflictedFormItem","item","state","cleanup","popoverVisible","popoverTemplate","showPopover","blur","helpers","getHotkeyInputInformationLists","depend","hotkeyDefinitions","list","commandDefinitions","commandName","label","left","splice","Math","ceil","right","hotkeysFormTable","getLabel","input","result","presetIndex","parseInt","replace","preset","viewer","wlPresets","id","Router","onBeforeAction","lastRoute","currentRoute","router","current","route","getName","next"],"mappings":"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","file":"/packages/ohif_hotkeys.js","sourcesContent":["import { OHIF } from 'meteor/ohif:core';\nimport { HotkeysManager } from 'meteor/ohif:hotkeys/client/classes/HotkeysManager';\nimport 'jquery.hotkeys';\n\n// Create hotkeys namespace using a HotkeysManager class instance\nconst hotkeys = new HotkeysManager();\n\n// Append hotkeys namespace to OHIF namespace\nOHIF.hotkeys = hotkeys;\n\n// Export relevant objects\nexport { hotkeys };\n","import './components';\nimport './lib';\n","import { OHIF } from 'meteor/ohif:core';\n\nexport class HotkeysContext {\n    constructor(name, definitions, enabled) {\n        this.name = name;\n        this.definitions = Object.assign({}, definitions);\n        this.enabled = enabled;\n    }\n\n    extend(definitions={}) {\n        if (typeof definitions !== 'object') return;\n        this.definitions = Object.assign({}, definitions);\n        Object.keys(definitions).forEach(command => {\n            const hotkey = definitions[command];\n            this.unregister(command);\n            if (hotkey) {\n                this.register(command, hotkey);\n            }\n\n            this.definitions[command] = hotkey;\n        });\n    }\n\n    register(command, hotkey) {\n        if (!hotkey) {\n            return;\n        }\n\n        if (!command) {\n            return OHIF.log.warn(`No command was defined for hotkey \"${hotkey}\"`);\n        }\n\n        const bindingKey = `keydown.hotkey.${this.name}.${command}`;\n        const bind = hotkey => $(document).bind(bindingKey, hotkey, event => {\n            if (!this.enabled.get()) return;\n            OHIF.commands.run(command);\n            event.preventDefault();\n        });\n\n        if (hotkey instanceof Array) {\n            hotkey.forEach(hotkey => bind(hotkey));\n        } else {\n            bind(hotkey);\n        }\n    }\n\n    unregister(command) {\n        const bindingKey = `keydown.hotkey.${this.name}.${command}`;\n        if (this.definitions[command]) {\n            $(document).unbind(bindingKey);\n            delete this.definitions[command];\n        }\n    }\n\n    initialize() {\n        Object.keys(this.definitions).forEach(command => {\n            const hotkey = this.definitions[command];\n            this.register(command, hotkey);\n        });\n    }\n\n    destroy() {\n        $(document).unbind(`keydown.hotkey.${this.name}`);\n    }\n}\n","import { Meteor } from 'meteor/meteor';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { Tracker } from 'meteor/tracker';\nimport { Session } from 'meteor/session';\nimport { OHIF } from 'meteor/ohif:core';\nimport { HotkeysContext } from 'meteor/ohif:hotkeys/client/classes/HotkeysContext';\n\nexport class HotkeysManager {\n    constructor() {\n        this.contexts = {};\n        this.defaults = {};\n        this.currentContextName = null;\n        this.enabled = new ReactiveVar(true);\n        this.retrieveFunction = null;\n        this.storeFunction = null;\n        this.changeObserver = new Tracker.Dependency();\n\n        Tracker.autorun(() => {\n            const contextName = OHIF.context.get();\n\n            // Avoind falling in MongoDB collections reactivity\n            Tracker.nonreactive(() => this.switchToContext(contextName));\n        });\n    }\n\n    setRetrieveFunction(retrieveFunction) {\n        this.retrieveFunction = retrieveFunction;\n    }\n\n    setStoreFunction(storeFunction) {\n        this.storeFunction = storeFunction;\n    }\n\n    store(contextName, definitions) {\n        const storageKey = `hotkeysDefinitions.${contextName}`;\n        return new Promise((resolve, reject) => {\n            if (this.storeFunction) {\n                this.storeFunction.call(this, storageKey, definitions).then(resolve).catch(reject);\n            } else if (Meteor.userId()) {\n                OHIF.user.setData(storageKey, definitions).then(resolve).catch(reject);\n            } else {\n                Session.setPersistent(storageKey, definitions);\n                resolve();\n            }\n        });\n    }\n\n    retrieve(contextName) {\n        const storageKey = `hotkeysDefinitions.${contextName}`;\n        return new Promise((resolve, reject) => {\n            if (this.retrieveFunction) {\n                this.retrieveFunction(contextName).then(resolve).catch(reject);\n            } else if (OHIF.user) {\n                try {\n                    resolve(OHIF.user.getData(storageKey));\n                } catch(error) {\n                    reject(error);\n                }\n            } else {\n                resolve(Session.get(storageKey));\n            }\n        });\n    }\n\n    disable() {\n        this.enabled.set(false);\n    }\n\n    enable() {\n        this.enabled.set(true);\n    }\n\n    getContext(contextName) {\n        return this.contexts[contextName];\n    }\n\n    getCurrentContext() {\n        return this.getContext(this.currentContextName);\n    }\n\n    load(contextName) {\n        return new Promise((resolve, reject) => {\n            const context = this.getContext(contextName);\n            if (!context) return reject();\n            this.retrieve(contextName).then(defs => {\n                const definitions = defs || this.defaults[contextName];\n                if (!definitions) {\n                    this.changeObserver.changed();\n                    return reject();\n                }\n\n                context.destroy();\n                context.definitions = definitions;\n                context.initialize();\n                this.changeObserver.changed();\n                resolve(definitions);\n            }).catch(reject);\n        });\n    }\n\n    set(contextName, contextDefinitions, isDefaultDefinitions=false) {\n        const enabled = this.enabled;\n        const context = new HotkeysContext(contextName, contextDefinitions, enabled);\n        const currentContext = this.getCurrentContext();\n        if (currentContext && currentContext.name === contextName) {\n            currentContext.destroy();\n            context.initialize();\n        }\n\n        this.contexts[contextName] = context;\n        if (isDefaultDefinitions) {\n            this.defaults[contextName] = contextDefinitions;\n        }\n    }\n\n    register(contextName, command, hotkey) {\n        if (!command || !hotkey) return;\n        const context = this.getContext(contextName);\n        if (!context) {\n            this.set(contextName, {});\n        }\n\n        context.register(command, hotkey);\n    }\n\n    unsetContext(contextName) {\n        if (contextName === this.currentContextName) {\n            this.getCurrentContext().destroy();\n        }\n\n        delete this.contexts[contextName];\n        delete this.defaults[contextName];\n    }\n\n    resetDefauls(contextName) {\n        const context = this.getContext(contextName);\n        const definitions = this.defaults[contextName];\n        if (!context || !definitions) return;\n        context.extend(definitions);\n        return this.store(contextName, definitions).then(this.changeObserver.changed);\n    }\n\n    switchToContext(contextName) {\n        const currentContext = this.getCurrentContext();\n        if (currentContext) {\n            currentContext.destroy();\n        }\n\n        const newContext = this.contexts[contextName];\n        if (!newContext) return;\n\n        this.currentContextName = contextName;\n        newContext.initialize();\n        this.load(contextName).catch(() => {});\n    }\n}\n","import { Template } from 'meteor/templating';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { $ } from 'meteor/jquery';\nimport { _ } from 'meteor/underscore';\nimport { OHIF } from 'meteor/ohif:core';\n\nTemplate.hotkeysForm.onCreated(() => {\n    const instance = Template.instance();\n    const { contextName } = instance.data;\n\n    instance.api = {\n        save() {\n            const form = instance.$('form').first().data('component');\n            const definitions = form.value();\n            const promise = OHIF.hotkeys.store(contextName, definitions);\n            promise.then(() => {\n                const successMessage = 'The keyboard shortcut preferences were successfully saved.';\n                OHIF.ui.notifications.success({ text: successMessage });\n                OHIF.hotkeys.load(contextName).then(defs => instance.hotkeysDefinitions.set(defs));\n            });\n            return promise;\n        },\n\n        resetDefaults() {\n            const dialogOptions = {\n                class: 'themed',\n                title: 'Reset Keyboard Shortcuts',\n                message: 'Are you sure you want to reset all the shortcuts to their defaults?'\n            };\n\n            return OHIF.ui.showDialog('dialogConfirm', dialogOptions).then(() => {\n                return OHIF.hotkeys.resetDefauls(contextName);\n            });\n        }\n    };\n\n    const rg = (start, end) => _.range(start, end + 1);\n    instance.allowedKeys = _.union(\n        [8, 13, 27, 32, 46], // BACKSPACE, ENTER, ESCAPE, SPACE, DELETE\n        [12, 106, 107, 109, 110, 111], // Numpad keys\n        rg(219, 221), // [\\]\n        rg(186, 191), // ;=,-./\n        rg(112, 130), // F1-F19\n        rg(33, 40), // arrow keys, home/end, pg dn/up\n        rg(48, 57), // 0-9\n        rg(65, 90) // A-Z\n    );\n\n    instance.updateInputText = (event, displayPressedKey=false) => {\n        const $target = $(event.currentTarget);\n        const keysPressedArray = instance.getKeysPressedArray(event);\n\n        if (displayPressedKey) {\n            const specialKeyName = jQuery.hotkeys.specialKeys[event.which];\n            const keyName = specialKeyName || String.fromCharCode(event.keyCode) || event.key;\n            keysPressedArray.push(keyName.toUpperCase());\n        }\n\n        $target.val(keysPressedArray.join('+'));\n    };\n\n    instance.getKeysPressedArray = event => {\n        const keysPressedArray = [];\n\n        if (event.ctrlKey && !event.altKey) {\n            keysPressedArray.push('CTRL');\n        }\n\n        if (event.shiftKey && !event.altKey) {\n            keysPressedArray.push('SHIFT');\n        }\n\n        if (event.altKey && !event.ctrlKey) {\n            keysPressedArray.push('ALT');\n        }\n\n        return keysPressedArray;\n    };\n\n    instance.getConflictingCommand = (currentCommand, currentCombination) => {\n        const form = instance.$('form').first().data('component');\n        const hotkeys = form.value();\n\n        let conflict = '';\n        _.each(hotkeys, (combination, command) => {\n            if (combination && combination === currentCombination && command !== currentCommand) {\n                conflict = command;\n            }\n        });\n\n        return conflict;\n    };\n\n    instance.disallowedCombinations = {\n        '': [],\n        ALT: ['SPACE'],\n        SHIFT: [],\n        CTRL: ['F4', 'F5', 'F11', 'W', 'R', 'T', 'O', 'P', 'A', 'D', 'F', 'G', 'H', 'J', 'L', 'Z', 'X', 'C', 'V', 'B', 'N', 'PAGEDOWN', 'PAGEUP'],\n        'CTRL+SHIFT': ['Q', 'W', 'R', 'T', 'P', 'A', 'H', 'V', 'B', 'N']\n    };\n\n    const hotkeysContext = OHIF.hotkeys.getContext(contextName) || {};\n    instance.hotkeysDefinitions = new ReactiveVar(hotkeysContext.definitions);\n    OHIF.hotkeys.load(contextName).then(defs => instance.hotkeysDefinitions.set(defs));\n});\n\nTemplate.hotkeysForm.events({\n    'keydown .hotkey'(event, instance) {\n        // Prevent ESC key from propagating and closing the modal\n        if (event.keyCode === 27) {\n            event.stopPropagation();\n        }\n\n        if (instance.allowedKeys.indexOf(event.keyCode) > -1) {\n            instance.updateInputText(event, true);\n            $(event.currentTarget).trigger('hotkeyChange');\n        } else {\n            instance.updateInputText(event);\n        }\n\n        event.preventDefault();\n    },\n\n    'hotkeyChange .hotkey'(event, instance, data={}) {\n        const $target = $(event.currentTarget);\n        const combination = $target.val();\n        const keys = combination.split('+');\n        const lastKey = keys.pop();\n        const modifierCombination = keys.join('+');\n        const isModifier = ['CTRL', 'ALT', 'SHIFT'].indexOf(lastKey) > -1;\n\n        const formItem = $target.data('component');\n        const conflictedCommand = instance.getConflictingCommand(this.key, combination);\n        if (isModifier) {\n            // Clean the input if left with only a modifier key or browser specific command\n            formItem.error(`It's not possible to define only modifier keys (CTRL, ALT and SHIFT) as a shortcut`);\n            $target.val('').focus();\n        } else if (instance.disallowedCombinations[modifierCombination].indexOf(lastKey) > -1) {\n            // Clean the input and show error if combination is not allowed\n            formItem.error(`The \"${combination}\" shortcut combination is not allowed`);\n            $target.val('').focus();\n        } else if (conflictedCommand) {\n            if (data.blurTrigger) return;\n\n            // Remove the error message\n            formItem.error(false);\n            formItem.toggleTooltip(false);\n\n            const placement = $target.closest('.hotkeys-left').length ? 'right' : 'left';\n            const commandsContext = OHIF.commands.getContext(instance.data.contextName);\n            const popoverData = {\n                conflictedFunctionName: commandsContext[conflictedCommand].name,\n                newFunctionName: commandsContext[this.key].name,\n                hotkeyCombination: combination,\n            };\n\n            const popoverOptions = {\n                event,\n                placement\n            };\n\n            const conflictedFormItem = instance.$('form').first().data('component').item(conflictedCommand);\n            formItem.state('error', true);\n            conflictedFormItem.state('error', true);\n\n            const cleanup = () => {\n                instance.popoverVisible = false;\n                formItem.state('error', false);\n                conflictedFormItem.state('error', false);\n            };\n\n            const popoverTemplate = 'hotkeysConfirmReplacementPopover';\n            instance.popoverVisible = true;\n            OHIF.ui.showPopover(popoverTemplate, popoverData, popoverOptions).then(() => {\n                cleanup();\n                formItem.value(combination);\n                conflictedFormItem.value('');\n                $target.blur();\n            }).catch(() => {\n                cleanup();\n                $target.val('').focus();\n            });\n        } else {\n            // Remove the error message and blur the component if everything is fine\n            formItem.error(false);\n            if (!data.blurTrigger) {\n                $target.blur();\n            }\n        }\n    },\n\n    'blur .hotkey'(event, instance, data={}) {\n        $(event.currentTarget).trigger('hotkeyChange', { blurTrigger: true });\n    },\n\n    'keyup .hotkey'(event, instance) {\n        if (!instance.popoverVisible) {\n            instance.updateInputText(event);\n        }\n    }\n});\n\nTemplate.hotkeysForm.helpers({\n    getHotkeyInputInformationLists() {\n        OHIF.hotkeys.changeObserver.depend();\n\n        const instance = Template.instance();\n        const { contextName } = instance.data;\n\n        const hotkeyDefinitions = instance.hotkeysDefinitions.get();\n        const commandsContext = OHIF.commands.getContext(contextName);\n        if (!hotkeyDefinitions || !commandsContext) return {};\n\n        const commands = Object.keys(OHIF.hotkeys.defaults[contextName] || {});\n        const list = [];\n        commands.forEach(commandName => {\n            const commandDefinitions = commandsContext[commandName];\n            if (!commandDefinitions) return;\n            list.push({\n                key: commandName,\n                label: commandDefinitions.name,\n                value: hotkeyDefinitions[commandName] || ''\n            });\n        });\n\n        const left = list.splice(0, Math.ceil(list.length / 2));\n        const right = list;\n\n        return {\n            left,\n            right\n        };\n    }\n});\n","import { Template } from 'meteor/templating';\nimport { OHIF } from 'meteor/ohif:core';\n\nTemplate.hotkeysFormTable.helpers({\n    getLabel(input) {\n        let result = input.label;\n        if (input.key.indexOf('WLPreset') === 0) {\n            const presetIndex = parseInt(input.key.replace('WLPreset', ''));\n            const preset = OHIF.viewer.wlPresets[presetIndex];\n            if (preset.id) {\n                result += ` (${preset.id})`;\n            }\n        }\n\n        return result;\n    }\n});\n","import './confirmReplacementPopover.html';\n\nimport './form.html';\nimport './form.js';\n\nimport './formTable.html';\nimport './formTable.js';\n","import './routes';\n","import { Router } from 'meteor/iron:router';\nimport { Session } from 'meteor/session';\nimport { hotkeys } from 'meteor/ohif:hotkeys';\n\nRouter.onBeforeAction(function() {\n    const lastRoute = Session.get('lastRoute');\n    const currentRoute = this.router.current().route.getName();\n    if (currentRoute !== lastRoute) {\n        hotkeys.switchToContext(null);\n        Session.set('lastRoute', currentRoute);\n    }\n\n    this.next();\n});\n"]}